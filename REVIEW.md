KeibaAI_v2 ã‚·ã‚¹ãƒ†ãƒ è©³ç´°åˆ†æãƒ¬ãƒãƒ¼ãƒˆ
ã‚¨ã‚°ã‚¼ã‚¯ãƒ†ã‚£ãƒ–ã‚µãƒãƒªãƒ¼
æœ¬ãƒ¬ãƒãƒ¼ãƒˆã¯ã€KeibaAI_v2 ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ãƒ‡ãƒ¼ã‚¿ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã‹ã‚‰ãƒ¢ãƒ‡ãƒ«å®Ÿè£…ã¾ã§ã®åŒ…æ‹¬çš„ãªåˆ†æã¨ã€ãƒ¢ãƒ‡ãƒ«ç²¾åº¦å‘ä¸Šã®ãŸã‚ã®å…·ä½“çš„æ”¹å–„ææ¡ˆã‚’æä¾›ã—ã¾ã™ã€‚

ä¸»è¦ãªç™ºè¦‹
âœ… ã‚·ã‚¹ãƒ†ãƒ ã®å¼·ã¿
æ´—ç·´ã•ã‚ŒãŸã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

Î¼ï¼ˆèƒ½åŠ›ï¼‰ã€Ïƒï¼ˆé¦¬å›ºæœ‰ã®ä¸ç¢ºå®Ÿæ€§ï¼‰ã€Î½ï¼ˆãƒ¬ãƒ¼ã‚¹å…¨ä½“ã®ä¸ç¢ºå®Ÿæ€§ï¼‰ã‚’å€‹åˆ¥ãƒ¢ãƒ‡ãƒ«åŒ–
LightGBM Regressor + Ranker ã®ã‚¢ãƒ³ã‚µãƒ³ãƒ–ãƒ«è¨­è¨ˆ
ãƒ¬ã‚·ãƒ”ãƒ™ãƒ¼ã‚¹ã®æŸ”è»Ÿãªç‰¹å¾´é‡ç”Ÿæˆã‚·ã‚¹ãƒ†ãƒ 
å …ç‰¢ãªãƒ‡ãƒ¼ã‚¿ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³

HTML è§£æã®å¤šæ®µéšãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯æ©Ÿæ§‹
æ™‚ç³»åˆ—ãƒ‡ãƒ¼ã‚¿ãƒªãƒ¼ã‚¯å¯¾ç­–ï¼ˆshift()ã«ã‚ˆã‚‹éå»ãƒ‡ãƒ¼ã‚¿ã®ã¿ä½¿ç”¨ï¼‰
27+ã‚«ãƒ©ãƒ ã®è©³ç´°ãªãƒ¬ãƒ¼ã‚¹æƒ…å ±æŠ½å‡º
ç¾åœ¨ã®ãƒ‡ãƒ¼ã‚¿è¦æ¨¡

278,098 ãƒ¬ãƒ¼ã‚¹è¨˜éŒ²
1,377,361 è¡€çµ±ãƒ¬ã‚³ãƒ¼ãƒ‰ï¼ˆ5 ä¸–ä»£ï¼‰
ãƒ‡ãƒ¼ã‚¿æ¬ æç‡ã®æ”¹å–„å®Ÿç¸¾ï¼ˆHTML ãƒ‘ãƒ¼ã‚µãƒ¼ä¿®æ­£ã«ã‚ˆã‚Š 0.8%â†’ ã»ã¼ 0%ï¼‰
âš ï¸ æ”¹å–„ã®æ©Ÿä¼š
ãƒ‡ãƒ¼ã‚¿æ´»ç”¨ã®ä¸è¶³

é¦¬ã®éå»æˆç¸¾ï¼ˆhorses_performanceï¼‰ãŒæœªä¿å­˜
è¡€çµ±æƒ…å ±ã®è©³ç´°ï¼ˆç”Ÿå¹´ã€æ¯›è‰²ï¼‰ãŒæœªæ´»ç”¨
ãƒ¬ãƒ¼ã‚¹å†…æ´¾ç”Ÿç‰¹å¾´é‡ã®å¯èƒ½æ€§
ç‰¹å¾´é‡ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ãƒªãƒ³ã‚°

äº¤äº’ä½œç”¨ç‰¹å¾´é‡ï¼ˆé¨æ‰‹ Ã— ç«¶é¦¬å ´ãªã©ï¼‰ã®ä½“ç³»çš„ç”ŸæˆãŒæœªå®Ÿè£…
è„šè³ªã®å®šç¾©ã¨ç‰¹å¾´é‡åŒ–ãŒæœªå®Ÿè£…
Embedding ã«ã‚ˆã‚‹é«˜æ¬¡å…ƒè¡¨ç¾ãŒæœªæ´»ç”¨
ãƒ¢ãƒ‡ãƒ«æœ€é©åŒ–

ãƒã‚¤ãƒ‘ãƒ¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æœ€é©åŒ–ã®è‡ªå‹•åŒ–ãŒæœªå®Ÿè£…
ã‚«ã‚¹ã‚¿ãƒ æå¤±é–¢æ•°ï¼ˆFocal Loss ç­‰ï¼‰ã®æœªå°å…¥

1. ã‚·ã‚¹ãƒ†ãƒ å…¨ä½“ã®ç†è§£
   1.1 ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£æ¦‚è¦
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ PHASE 1: ã‚¹ã‚¯ãƒ¬ã‚¤ãƒ”ãƒ³ã‚° â”‚
   â”‚ netkeiba.com â†’ HTML (.bin, EUC-JP) â”‚
   â”‚ - race results (ãƒ¬ãƒ¼ã‚¹çµæœ) â”‚
   â”‚ - shutuba (å‡ºé¦¬è¡¨) â”‚
   â”‚ - horse profiles (é¦¬ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«) â”‚
   â”‚ - pedigrees (è¡€çµ±) â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   â†“
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ PHASE 2: ãƒ‘ãƒ¼ã‚¹å‡¦ç† â”‚
   â”‚ HTML â†’ Parquet (BeautifulSoup + pandas) â”‚
   â”‚ - races.parquet (278K records, 27+ cols) â”‚
   â”‚ - shutuba.parquet (278K records, 21 cols) â”‚
   â”‚ - horses.parquet (ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«æƒ…å ±) â”‚
   â”‚ - pedigrees.parquet (1.3M records) â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   â†“
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ PHASE 3: ç‰¹å¾´é‡ç”Ÿæˆ â”‚
   â”‚ FeatureEngine (ãƒ¬ã‚·ãƒ”ãƒ™ãƒ¼ã‚¹) â”‚
   â”‚ - åŸºæœ¬ç‰¹å¾´é‡ (å¹´é½¢ã€æ–¤é‡ã€æ€§åˆ¥ç­‰) â”‚
   â”‚ - éå»æˆç¸¾é›†ç´„ (rolling stats) â”‚
   â”‚ - é¨æ‰‹/èª¿æ•™å¸«çµ±è¨ˆ â”‚
   â”‚ - ãƒ¬ãƒ¼ã‚¹å†…ç›¸å¯¾ç‰¹å¾´é‡ (z-score) â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   â†“
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ PHASE 4: ãƒ¢ãƒ‡ãƒ«å­¦ç¿’ãƒ»æ¨è«– â”‚
   â”‚ Î¼ ãƒ¢ãƒ‡ãƒ«: LightGBM (Regressor + Ranker) â”‚
   â”‚ Ïƒ ãƒ¢ãƒ‡ãƒ«: äºˆæ¸¬èª¤å·®ã®åˆ†æ•£æ¨å®š â”‚
   â”‚ Î½ ãƒ¢ãƒ‡ãƒ«: ãƒ¬ãƒ¼ã‚¹å…¨ä½“ã®ä¸ç¢ºå®Ÿæ€§ â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   â†“
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ PHASE 5: ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ & æœ€é©åŒ– â”‚
   â”‚ Monte Carlo (K=1000) â†’ ç¢ºç‡æ¨å®š â”‚
   â”‚ Fractional Kelly â†’ ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ªæœ€é©åŒ– â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
2. ãƒ‡ãƒ¼ã‚¿ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³è©³ç´°åˆ†æ
   2.1 ã‚¹ã‚¯ãƒ¬ã‚¤ãƒ”ãƒ³ã‚°æˆ¦ç•¥
   å¯¾è±¡ã‚µã‚¤ãƒˆ: netkeiba.com, JRA å…¬å¼

æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯:

requests (åŸºæœ¬çš„ãª HTTP å–å¾—)
BeautifulSoup4 (HTML è§£æ)
Selenium (JRA ã‚ªãƒƒã‚ºå–å¾—ç”¨)
ã‚¢ãƒ³ãƒ BAN ãƒ¡ã‚«ãƒ‹ã‚ºãƒ :

ãƒ©ãƒ³ãƒ€ãƒ å¾…æ©Ÿæ™‚é–“: 2.5-5 ç§’
HTTP 400 æ¤œå‡º â†’ 60 ç§’ä¼‘æ­¢
User-Agent ãƒ­ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³
æŒ‡æ•°ãƒãƒƒã‚¯ã‚ªãƒ•ã«ã‚ˆã‚‹ãƒªãƒˆãƒ©ã‚¤
ãƒ‡ãƒ¼ã‚¿ä¿å­˜å½¢å¼:

.bin ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆEUC-JP ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ï¼‰
immutable storageï¼ˆåŸæœ¬ä¿æŒï¼‰
SQLite ã«ã‚ˆã‚‹ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ç®¡ç†
2.2 ãƒ‘ãƒ¼ã‚¹å‡¦ç†ã®è©³ç´°
2.2.1 ãƒ¬ãƒ¼ã‚¹çµæœãƒ‘ãƒ¼ã‚µãƒ¼ (results_parser.py)
ä¸»è¦ãªå®Ÿè£…æ”¹å–„:

HTML è§£æãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ lxml â†’ html.parser ã«å¤‰æ›´ï¼ˆäº’æ›æ€§å‘ä¸Šï¼‰
4 æ®µéšãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯æ©Ÿæ§‹ã«ã‚ˆã‚‹è·é›¢ãƒ»é¦¬å ´æƒ…å ±ã®å …ç‰¢ãªæŠ½å‡º
é€šéé †ä½ã® 4 åˆ†å‰²æŠ½å‡ºï¼ˆå„ã‚³ãƒ¼ãƒŠãƒ¼å€‹åˆ¥ï¼‰
æŠ½å‡ºã‚«ãƒ©ãƒ ä¸€è¦§ï¼ˆ27+ã‚«ãƒ©ãƒ ï¼‰:

| ã‚«ãƒ†ã‚´ãƒª | ã‚«ãƒ©ãƒ å | ãƒ‡ãƒ¼ã‚¿å‹ | èª¬æ˜ | |---------|---------|---------|------| | åŸºæœ¬æƒ…å ± | race*id | string | ãƒ¬ãƒ¼ã‚¹ ID (YYYYPPNNDDRR) | | | race_date | date | ãƒ¬ãƒ¼ã‚¹é–‹å‚¬æ—¥ | | | race_name | string | ãƒ¬ãƒ¼ã‚¹å | | | venue | string | ç«¶é¦¬å ´å | | | round_of_year | Int64 | é–‹å‚¬å›æ•° | | | day_of_meeting | Int64 | é–‹å‚¬æ—¥ç›® | | ãƒ¬ãƒ¼ã‚¹æ¡ä»¶ | distance_m | Int64 | è·é›¢ï¼ˆãƒ¡ãƒ¼ãƒˆãƒ«ï¼‰ | | | track_surface | string | é¦¬å ´ç¨®åˆ¥ï¼ˆèŠ/ãƒ€ãƒ¼ãƒˆ/éšœå®³ï¼‰ | | | weather | string | å¤©å€™ | | | track_condition | string | é¦¬å ´çŠ¶æ…‹ | | | post_time | string | ç™ºèµ°æ™‚åˆ» | | | race_class | string | ãƒ¬ãƒ¼ã‚¹ã‚¯ãƒ©ã‚¹ï¼ˆG1/OP/æœªå‹åˆ©ç­‰ï¼‰ | | ç€é †æƒ…å ± | finish_position | Int64 | ç€é † | | | bracket_number | Int64 | æ ç•ª | | | horse_number | Int64 | é¦¬ç•ª | | é¦¬æƒ…å ± | horse_id | string | é¦¬ ID | | | horse_name | string | é¦¬å | | | sex | string | æ€§åˆ¥ï¼ˆç‰¡/ç‰/ã‚»ï¼‰ | | | age | Int64 | å¹´é½¢ | | | horse_weight | Int64 | é¦¬ä½“é‡ | | | horse_weight_change | Int64 | é¦¬ä½“é‡å¢—æ¸› | | äººæƒ…å ± | jockey_id | string | é¨æ‰‹ ID | | | jockey_name | string | é¨æ‰‹å | | | basis_weight | float64 | æ–¤é‡ | | | trainer_id | string | èª¿æ•™å¸« ID | | | trainer_name | string | èª¿æ•™å¸«å | | | owner_name | string | é¦¬ä¸»å | | èµ°è¡Œãƒ‡ãƒ¼ã‚¿ | finish_time_seconds | float64 | èµ°ç ´ã‚¿ã‚¤ãƒ ï¼ˆç§’ï¼‰ | | | margin_seconds | float64 | 1 ç€ã¨ã®ã‚¿ã‚¤ãƒ å·®ï¼ˆç§’ï¼‰ | | | passing_order_1~4 | Int64 | å„ã‚³ãƒ¼ãƒŠãƒ¼é€šéé †ä½ | | | last_3f_time | float64 | ä¸ŠãŒã‚Š 3 ãƒãƒ­ãƒ³ã‚¿ã‚¤ãƒ  | | å¸‚å ´ãƒ‡ãƒ¼ã‚¿ | win_odds | float64 | å˜å‹ã‚ªãƒƒã‚º | | | popularity | Int64 | äººæ°—é † | | è³é‡‘ | prize_1st~5th | Int64 | 1ã€œ5 ç€è³é‡‘ï¼ˆä¸‡å††ï¼‰ | | æ´¾ç”Ÿç‰¹å¾´é‡ | time_except_last3f | float64 | ä¸ŠãŒã‚Š 3F é™¤å¤–ã‚¿ã‚¤ãƒ  | | | pace_index | float64 | ãƒšãƒ¼ã‚¹æŒ‡æ•°ï¼ˆå‰åŠ/å¾ŒåŠæ¯”ï¼‰ | | | last3f_rank | float64 | ãƒ¬ãƒ¼ã‚¹å†…ä¸ŠãŒã‚Š 3F é †ä½ | | | position_change*\* | Int64 | ã‚³ãƒ¼ãƒŠãƒ¼é–“é †ä½å¤‰å‹• | | | horse_weight_deviation | float64 | é¦¬ä½“é‡åå·®å€¤ | | | popularity_finish_diff | Int64 | äººæ°—ã¨ç€é †ã®ä¹–é›¢ | | | win_probability | float64 | ã‚ªãƒƒã‚ºé€†æ•°ç¢ºç‡ | | | distance_category | category | è·é›¢åŒºåˆ†ï¼ˆsprint/mile ç­‰ï¼‰ |

ã‚³ãƒ¼ãƒ‰ä¾‹ (results_parser.py:69-172):

def extract*race_metadata_enhanced(soup: BeautifulSoup) -> Dict:
"""æ‹¡å¼µã•ã‚ŒãŸãƒ¬ãƒ¼ã‚¹ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿æŠ½å‡º""" # 4 æ®µéšãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯
race_data_intro = soup.find('div', class*='data_intro')
if race_data_intro: # ãƒ¬ãƒ™ãƒ« 1: data_intro ã‹ã‚‰æŠ½å‡º
... # ãƒ¬ãƒ™ãƒ« 2: diary_snap_cut ã‹ã‚‰æŠ½å‡º # ãƒ¬ãƒ™ãƒ« 3: racedata ã‹ã‚‰æŠ½å‡º # ãƒ¬ãƒ™ãƒ« 4: ä»£æ›¿ã‚»ãƒ¬ã‚¯ã‚¿
ç¾åœ¨ã®æ¬ æç‡ (PROGRESS.md ã‚ˆã‚Š):

prize_money: 63.7% (1 ç€ã®ã¿è¨˜éŒ²ã®ãŸã‚æ­£å¸¸)
margin_seconds: 2.86% (1 ç€ã¯å·®ãªã—ã®ãŸã‚æ­£å¸¸)
finish_position: 0.82% (ä¸­æ­¢ãƒ»é™¤å¤–é¦¬)
ãã®ä»–ä¸»è¦ã‚«ãƒ©ãƒ : 0% (ãƒ‘ãƒ¼ã‚µãƒ¼æ”¹å–„ã«ã‚ˆã‚Šé”æˆ)
2.2.2 å‡ºé¦¬è¡¨ãƒ‘ãƒ¼ã‚µãƒ¼ (shutuba_parser.py)
æŠ½å‡ºã‚«ãƒ©ãƒ ï¼ˆ21 ã‚«ãƒ©ãƒ ï¼‰:

åŸºæœ¬æƒ…å ±: race_id, race_date, bracket_number, horse_number
é¦¬æƒ…å ±: horse_id, horse_name, sex, age
äººæƒ…å ±: jockey_id/name, trainer_id/name
é‡é‡: basis_weight, horse_weight, horse_weight_change
äºˆæ¸¬æƒ…å ±: morning_odds, morning_popularity
ãƒ•ãƒ©ã‚°: scratched (å–æ¶ˆãƒ•ãƒ©ã‚°)
æœªå®Ÿè£…ã ãŒå–å¾—å¯èƒ½ãªãƒ‡ãƒ¼ã‚¿ (schema.md å‚ç…§):

blinkers (boolean): ãƒ–ãƒªãƒ³ã‚«ãƒ¼è£…ç€
prediction_mark (string): äºˆæƒ³å°ï¼ˆâ—â—‹â–²â–³ ç­‰ï¼‰
2.2.3 é¦¬ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‘ãƒ¼ã‚µãƒ¼ (horse_info_parser.py)
æŠ½å‡ºã‚«ãƒ©ãƒ :

åŸºæœ¬æƒ…å ±: horse_id, horse_name, birth_date, sex, coat_color
ç”Ÿç”£æƒ…å ±: breeder_name, producing_area
æ‰€å±æƒ…å ±: trainer_id/name, owner_name
è¡€çµ±: sire_id/name, dam_id/name, damsire_id/name
æœªå®Ÿè£…ã ãŒå–å¾—å¯èƒ½ãªãƒ‡ãƒ¼ã‚¿:

height_cm (Int16): é¦¬ä½“é«˜
chest_girth_cm (Int16): èƒ¸å›²
cannon_bone_cm (float32): ç®¡å›²
sale_price (Int32): ã‚»ãƒªå–å¼•ä¾¡æ ¼
2.2.4 è¡€çµ±ãƒ‘ãƒ¼ã‚µãƒ¼ (pedigree_parser.py)
ç¾åœ¨ã®å®Ÿè£…:

horse_id, ancestor_id, ancestor_name, generation (1-5 ä¸–ä»£)
æœªå®Ÿè£…ã ãŒå–å¾—å¯èƒ½ãªãƒ‡ãƒ¼ã‚¿:

ancestor_birth_year (Int16): ç¥–å…ˆé¦¬ã®ç”Ÿå¹´
ancestor_coat_color (string): ç¥–å…ˆé¦¬ã®æ¯›è‰²
2.3 ãƒ‡ãƒ¼ã‚¿å“è³ªã®æ”¹å–„å®Ÿç¸¾
å•é¡Œ: å½“åˆã€races.parquet ã« 0.8%ã®ãƒ‡ãƒ¼ã‚¿æ¬ æãŒç™ºç”Ÿ

åŸå› ç‰¹å®šãƒ—ãƒ­ã‚»ã‚¹:

ãƒ­ã‚°ã‹ã‚‰ã€Œãƒ†ãƒ¼ãƒ–ãƒ«ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€ã‚¨ãƒ©ãƒ¼ã‚’ç¢ºèª
.bin ãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª¿æŸ» â†’ æœ‰åŠ¹ãª HTML ãŒå­˜åœ¨
HTML ãƒ‘ãƒ¼ã‚µãƒ¼ãƒ©ã‚¤ãƒ–ãƒ©ãƒªï¼ˆlxmlï¼‰ã¨ã®ç›¸æ€§å•é¡Œã‚’ç‰¹å®š
å¯¾ç­–:

BeautifulSoup ã®ãƒ‘ãƒ¼ã‚µãƒ¼ã‚’ lxml â†’ html.parser ã«å¤‰æ›´
çµæœ:

æ¬ æç‡ 0.8% â†’ ã»ã¼ 0% ã«æ”¹å–„
278,098 ãƒ¬ã‚³ãƒ¼ãƒ‰å…¨ä½“ãŒæ­£å¸¸ã«ãƒ‘ãƒ¼ã‚¹å¯èƒ½ã« 3. ç‰¹å¾´é‡ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ãƒªãƒ³ã‚°ã®åˆ†æ
3.1 ãƒ¬ã‚·ãƒ”ãƒ™ãƒ¼ã‚¹ã‚·ã‚¹ãƒ†ãƒ ã®è¨­è¨ˆ
å®Ÿè£…ãƒ•ã‚¡ã‚¤ãƒ«: keibaai/src/features/feature_engine.py

è¨­è¨ˆæ€æƒ³:

YAML ãƒ•ã‚¡ã‚¤ãƒ« (features.yaml) ã§ç‰¹å¾´é‡ç”Ÿæˆãƒ­ã‚¸ãƒƒã‚¯ã‚’å®šç¾©
ã‚³ãƒ¼ãƒ‰å¤‰æ›´ãªã—ã§å®Ÿé¨“å¯èƒ½ãªæŸ”è»Ÿæ€§
å†ç¾æ€§ã®ç¢ºä¿ï¼ˆãƒ¬ã‚·ãƒ”ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†ï¼‰
ä¸»è¦ãªç‰¹å¾´é‡ã‚«ãƒ†ã‚´ãƒª:

3.1.1 åŸºæœ¬ç‰¹å¾´é‡ (\_add_basic_features)

# One-Hot Encoding

sex*ç‰¡, sex*ç‰, sex*ã‚»
track*èŠ, track*ãƒ€ãƒ¼ãƒˆ, track*éšœå®³

# Bracket Categorization

bracket_is_inner (å†…æ : 1-3)
bracket_is_middle (ä¸­æ : 4-6)
bracket_is_outer (å¤–æ : 7-8)
3.1.2 é€šç®—æˆç¸¾ç‰¹å¾´é‡ (\_add_career_stats)
career_starts: é€šç®—å‡ºèµ°å›æ•°
career_wins: é€šç®—å‹åˆ©æ•°
prize_total: ç·ç²å¾—è³é‡‘
é‡è¦: shift(1) ã«ã‚ˆã‚‹æ™‚ç³»åˆ—ãƒªãƒ¼ã‚¯å¯¾ç­–

df['career_wins'] = grouped['is_win'].cumsum().shift(1).fillna(0)

# â†‘ å½“è©²ãƒ¬ãƒ¼ã‚¹ã€Œã‚ˆã‚Šå‰ã€ã®ãƒ‡ãƒ¼ã‚¿ã®ã¿ã‚’é›†è¨ˆ

3.1.3 éå»èµ°é›†ç´„ç‰¹å¾´é‡ (\_add_past_performance_features)

# features.yaml ã®è¨­å®šä¾‹

past_performance:
enabled: true
columns: [finish_position, last_3f_time, margin_seconds]
windows: [1, 3, 5, 10] # éå» 1 èµ°ã€3 èµ°ã€5 èµ°ã€10 èµ°
aggregations: [mean, median, std, min, max]
ç”Ÿæˆã•ã‚Œã‚‹ç‰¹å¾´é‡ä¾‹:

past_1_finish_position_mean # å‰èµ°ç€é †
past_3_finish_position_mean # éå» 3 èµ°å¹³å‡ç€é †
past_5_last_3f_time_std # éå» 5 èµ°ã®ä¸ŠãŒã‚Š 3F ã®æ¨™æº–åå·®
days_since_last_race # å‰èµ°ã‹ã‚‰ã®æ—¥æ•°
3.1.4 ä¹—ã‚Šæ›¿ã‚ã‚Šãƒ•ãƒ©ã‚° (\_add_change_flags)
is_jockey_changed: é¨æ‰‹ä¹—ã‚Šæ›¿ã‚ã‚Š (0/1)
is_trainer_changed: èª¿æ•™å¸«å¤‰æ›´ (0/1)
å®Ÿè£…çŠ¶æ³: âœ… å®Ÿè£…æ¸ˆã¿ï¼ˆreview_report.md ææ¡ˆ 1-3 ã‚ˆã‚Šï¼‰

3.1.5 ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£é›†è¨ˆç‰¹å¾´é‡ (\_add_entity_stats)
entity_stats:
entities: - name: jockey
id_column: jockey_id
target: is_win
agg: mean
feature_name: jockey_win_rate

    - name: trainer
      id_column: trainer_id
      target: is_win
      agg: mean
      feature_name: trainer_win_rate

3.1.6 ãƒ¬ãƒ¼ã‚¹å†…ç›¸å¯¾ç‰¹å¾´é‡ (\_add_relative_features)
horse_weight_zscore: ãƒ¬ãƒ¼ã‚¹å†…é¦¬ä½“é‡ã® Z-score
basis_weight_zscore: ãƒ¬ãƒ¼ã‚¹å†…æ–¤é‡ã® Z-score
career_starts_zscore: ãƒ¬ãƒ¼ã‚¹å†…å‡ºèµ°çµŒé¨“ã® Z-score
3.2 æœªå®Ÿè£…ã ãŒæœ‰åŠ¹ãªç‰¹å¾´é‡
3.2.1 äº¤äº’ä½œç”¨ç‰¹å¾´é‡ï¼ˆå„ªå…ˆåº¦: é«˜ï¼‰

# é¨æ‰‹ Ã— ç«¶é¦¬å ´

jockey*æ±äº¬\_win_rate
jockey*ä¸­å±±\_win_rate

# é¨æ‰‹ Ã— è·é›¢ã‚«ãƒ†ã‚´ãƒª

jockey_sprint_win_rate
jockey_mile_win_rate

# ç¨®ç‰¡é¦¬ Ã— é¦¬å ´çŠ¶æ…‹

sire_heavy_track_win_rate
sire_firm_track_win_rate

# æ ç•ª Ã— è·é›¢

inner_bracket_sprint_advantage
æœŸå¾…åŠ¹æœ:

ç‰¹å®šæ¡ä»¶ä¸‹ã§ã®å„ªä½æ€§ã‚’æ‰ãˆã‚‹
LightGBM ã®æ±ºå®šæœ¨ãŒè¤‡é›‘ãªç›¸äº’ä½œç”¨ã‚’å­¦ç¿’ã—ã‚„ã™ããªã‚‹
3.2.2 è„šè³ªç‰¹å¾´é‡ï¼ˆå„ªå…ˆåº¦: ä¸­ï¼‰

# éå»ã®é€šéé †ä½ã‹ã‚‰è„šè³ªã‚’å®šç¾©

running_style: "é€ƒã’" / "å…ˆè¡Œ" / "å·®ã—" / "è¿½è¾¼"

# è„šè³ªã‚¯ãƒ©ã‚¹ã‚¿ãƒªãƒ³ã‚°ï¼ˆK-Meansï¼‰

def classify_running_style(passing_orders):
avg_corner3 = np.mean(passing_order_3)
if avg_corner3 <= 3:
return "é€ƒã’ãƒ»å…ˆè¡Œ"
elif avg_corner3 <= 8:
return "å·®ã—"
else:
return "è¿½è¾¼"
3.2.3 Embedding ç‰¹å¾´é‡ï¼ˆå„ªå…ˆåº¦: ä¸­ï¼‰

# PyTorch ã§å­¦ç¿’ã—ãŸ Embedding

horse_embedding_dim16: [0.23, -0.45, 0.12, ...] # 16 æ¬¡å…ƒãƒ™ã‚¯ãƒˆãƒ«
sire_embedding_dim16: [0.78, 0.34, -0.21, ...]
å®Ÿè£…æ–¹æ³•:

é¦¬ ID ã‚’å…¥åŠ›ã€èƒ½åŠ›ã‚’äºˆæ¸¬ã™ã‚‹å˜ç´”ãª NN ã‚’å­¦ç¿’
ä¸­é–“å±¤ã®é‡ã¿ã‚’ç‰¹å¾´é‡ã¨ã—ã¦æŠ½å‡º
LightGBM ã®å…¥åŠ›ã«è¿½åŠ  4. ãƒ¢ãƒ‡ãƒ«ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£åˆ†æ
4.1 Î¼ ãƒ¢ãƒ‡ãƒ«ï¼ˆMuEstimatorï¼‰
ãƒ•ã‚¡ã‚¤ãƒ«: keibaai/src/models/model_train.py

è¨­è¨ˆæ€æƒ³:

é¦¬ã®ã€ŒåŸºç¤èƒ½åŠ›ã€ã‚’æ¨å®š
Regressor ã¨ Ranker ã®ã‚¢ãƒ³ã‚µãƒ³ãƒ–ãƒ«
å†…éƒ¨æ§‹é€ :

class MuEstimator:
def **init**(self, config):
self.model_regressor = lgb.LGBMRegressor(...) # ã‚¿ã‚¤ãƒ äºˆæ¸¬
self.model_ranker = lgb.LGBMRanker(...) # é †ä½äºˆæ¸¬
å­¦ç¿’ãƒ•ãƒ­ãƒ¼:

Regressor: finish_time_seconds ã‚’ç›®çš„å¤‰æ•°ã¨ã—ã¦å­¦ç¿’

äºˆæ¸¬å€¤ãŒå°ã•ã„ã»ã©é€Ÿã„é¦¬
Ranker: finish_position ã‚’ç›®çš„å¤‰æ•°ã€race_id ã§ã‚°ãƒ«ãƒ¼ãƒ—åŒ–

LambdaRank æå¤±ã«ã‚ˆã‚Šé †ä½ã‚’å­¦ç¿’
äºˆæ¸¬æ™‚ã®ã‚¢ãƒ³ã‚µãƒ³ãƒ–ãƒ«:

def predict(self, features_df): # 1. Regressor äºˆæ¸¬ï¼ˆã‚¿ã‚¤ãƒ ãŒå°ã•ã„ = ã‚¹ã‚³ã‚¢é«˜ã„ï¼‰
score_regressor = -self.model_regressor.predict(X)

    # 2. Rankeräºˆæ¸¬ï¼ˆã‚¹ã‚³ã‚¢ãŒå¤§ãã„ = é †ä½è‰¯ã„ï¼‰
    score_ranker = self.model_ranker.predict(X)

    # 3. ãƒ¬ãƒ¼ã‚¹ã”ã¨ã«Z-scoreæ­£è¦åŒ–
    score_regressor_norm = (score_regressor - mean) / std
    score_ranker_norm = (score_ranker - mean) / std

    # 4. åŠ é‡å¹³å‡
    final_score = (
        score_regressor_norm * 0.5 +
        score_ranker_norm * 0.5
    )
    return final_score

å¼·ã¿:

çµ¶å¯¾èƒ½åŠ›ï¼ˆã‚¿ã‚¤ãƒ ï¼‰ã¨ç›¸å¯¾èƒ½åŠ›ï¼ˆé †ä½ï¼‰ã®ä¸¡æ–¹ã‚’è€ƒæ…®
ãƒ¬ãƒ¼ã‚¹ã”ã¨ã®æ­£è¦åŒ–ã«ã‚ˆã‚Šç•°ãªã‚‹æ¡ä»¶é–“ã§æ¯”è¼ƒå¯èƒ½
æ”¹å–„ã®ä½™åœ°:

ã‚¢ãƒ³ã‚µãƒ³ãƒ–ãƒ«é‡ã¿ï¼ˆç¾åœ¨ 0.5:0.5ï¼‰ã®æœ€é©åŒ–
ãƒã‚¤ãƒ‘ãƒ¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®è‡ªå‹•æ¢ç´¢æœªå®Ÿè£…
4.2 Ïƒ ãƒ¢ãƒ‡ãƒ«ï¼ˆåˆ†æ•£æ¨å®šï¼‰
ç›®çš„: å„é¦¬ã®äºˆæ¸¬ã®ä¸ç¢ºå®Ÿæ€§ã‚’æ¨å®š

å®Ÿè£…çŠ¶æ³: åŸºæœ¬è¨­è¨ˆã‚ã‚Šï¼ˆè©³ç´°æœªç¢ºèªï¼‰

å­¦ç¿’ã‚¿ãƒ¼ã‚²ãƒƒãƒˆå€™è£œ:

Î¼ ãƒ¢ãƒ‡ãƒ«ã®äºˆæ¸¬èª¤å·®ã®äºŒä¹—
éå»ã®ç€é †ã®æ¨™æº–åå·®
4.3 Î½ ãƒ¢ãƒ‡ãƒ«ï¼ˆãƒ¬ãƒ¼ã‚¹å…¨ä½“ã®ä¸ç¢ºå®Ÿæ€§ï¼‰
ç›®çš„: ãƒ¬ãƒ¼ã‚¹ã®ã€Œè’ã‚Œã‚„ã™ã•ã€ã‚’æ¨å®š

å®Ÿè£…çŠ¶æ³: åŸºæœ¬è¨­è¨ˆã‚ã‚Š

å­¦ç¿’ã‚¿ãƒ¼ã‚²ãƒƒãƒˆå€™è£œ:

ç€é †ã®æ¨™æº–åå·®
ã‚ªãƒƒã‚ºã® Gini ä¿‚æ•°
ä¸Šä½äººæ°—ã¨ä¸‹ä½äººæ°—ã®ç€é †ç›¸é–¢ 5. ãƒ¢ãƒ‡ãƒ«ç²¾åº¦å‘ä¸Šã®ãŸã‚ã®å…·ä½“çš„æ”¹å–„ææ¡ˆ
5.1 ãƒ‡ãƒ¼ã‚¿åé›†ãƒ»ãƒ‘ãƒ¼ã‚¹ã®å¼·åŒ–
ææ¡ˆ A-1: é¦¬éå»æˆç¸¾ãƒ†ãƒ¼ãƒ–ãƒ«ã®ä¿å­˜ â­ï¸â­ï¸â­ï¸
ç¾çŠ¶: horse_info_parser.py ã« parse_horse_performance() é–¢æ•°ã¯å­˜åœ¨ã™ã‚‹ãŒã€ãƒ‡ãƒ¼ã‚¿ãŒä¿å­˜ã•ã‚Œã¦ã„ãªã„

å¯¾ç­–:

run_parsing_pipeline_local.py ã«é¦¬éå»æˆç¸¾ã®å‡¦ç†ã‚’è¿½åŠ 
æ–°è¦ãƒ†ãƒ¼ãƒ–ãƒ« horses_performance.parquet ã‚’ä½œæˆ
æœŸå¾…ã•ã‚Œã‚‹ã‚«ãƒ©ãƒ  (schema.md ã‚ˆã‚Š):

horse_id, race_date, venue, weather, race_number, race_name, race_id,
head_count, bracket_number, horse_number, finish_position, jockey_name,
basis_weight, distance_m, track_surface, finish_time_seconds,
margin_seconds, passing_order, last_3f_time, win_odds, popularity,
horse_weight, horse_weight_change
æœŸå¾…åŠ¹æœ:

ã‚ˆã‚Šè©³ç´°ãªéå»èµ°ãƒ‡ãƒ¼ã‚¿ã«ã‚ˆã‚‹ç‰¹å¾´é‡ã®ç²¾ç·»åŒ–
åŒè·é›¢ãƒ»åŒé¦¬å ´ã§ã®éå»æˆç¸¾é›†è¨ˆãŒå¯èƒ½
å®Ÿè£…å„ªå…ˆåº¦: æœ€é«˜

ææ¡ˆ A-2: è¡€çµ±è©³ç´°æƒ…å ±ã®è¿½åŠ  â­ï¸â­ï¸
è¿½åŠ ã‚«ãƒ©ãƒ :

ancestor_birth_year: ç¥–å…ˆé¦¬ã®ç”Ÿå¹´
ancestor_coat_color: ç¥–å…ˆé¦¬ã®æ¯›è‰²
å®Ÿè£…:

# pedigree_parser.py ã®æ‹¡å¼µ

def extract_ancestor_details(td_tag):
span = td_tag.find('span')
if span:
text = span.get_text(strip=True) # "1970 é¹¿æ¯›" ã®å½¢å¼
match = re.match(r'(\d{4})\s+(\S+)', text)
if match:
return {
'ancestor_birth_year': int(match.group(1)),
'ancestor_coat_color': match.group(2)
}
æœŸå¾…åŠ¹æœ:

ä¸–ä»£é–“éš”ã®è¨ˆç®—ï¼ˆè‹¥ã„ç¨®ç‰¡é¦¬åŠ¹æœï¼‰
æ¯›è‰²ãƒ‘ã‚¿ãƒ¼ãƒ³ã®åˆ†æ
ææ¡ˆ A-3: å‡ºé¦¬è¡¨ã‹ã‚‰ã®è¿½åŠ æƒ…å ± â­ï¸
è¿½åŠ ã‚«ãƒ©ãƒ :

blinkers (boolean): ãƒ–ãƒªãƒ³ã‚«ãƒ¼è£…ç€ãƒ•ãƒ©ã‚°
prediction_mark (string): äºˆæƒ³å°
å®Ÿè£…é›£æ˜“åº¦: ä½

5.2 ç‰¹å¾´é‡ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ãƒªãƒ³ã‚°ã®é«˜åº¦åŒ–
ææ¡ˆ B-1: äº¤äº’ä½œç”¨ç‰¹å¾´é‡ã®ä½“ç³»çš„å°å…¥ â­ï¸â­ï¸â­ï¸
å®Ÿè£…æˆ¦ç•¥:

# features.yaml ã¸ã®è¿½åŠ 

interaction*features:
enabled: true
interactions: - name: jockey_venue
id_column: jockey_id
context_column: venue
target: is_win
agg: mean
feature_name_template: "jockey*{context}\_win_rate"

    - name: sire_surface
      id_column: sire_id
      context_column: track_surface
      target: finish_position
      agg: mean
      feature_name_template: "sire_{context}_avg_finish"

ç”Ÿæˆã•ã‚Œã‚‹ç‰¹å¾´é‡ä¾‹:

jockey*æ±äº¬\_win_rate
jockey*ä¸­å±±*win_rate
sire*èŠ*avg_finish
sire*ãƒ€ãƒ¼ãƒˆ\_avg_finish
å®Ÿè£…å„ªå…ˆåº¦: é«˜

ææ¡ˆ B-2: è„šè³ªã®å®šç¾©ã¨ç‰¹å¾´é‡åŒ– â­ï¸â­ï¸
å®Ÿè£…æ–¹æ³•:

def classify_running_style(passing_orders_history):
"""éå»ã®é€šéé †ä½ã‹ã‚‰è„šè³ªã‚’åˆ†é¡"""
avg_corner2 = np.mean([p for p in passing_orders_history if p is not None])

    if avg_corner2 <= 3:
        return "front_runner"  # é€ƒã’ãƒ»å…ˆè¡Œ
    elif avg_corner2 <= 8:
        return "stalker"       # å·®ã—
    else:
        return "closer"        # è¿½è¾¼

ç‰¹å¾´é‡:

running_style_front_runner (0/1)
running_style_stalker (0/1)
running_style_closer (0/1)
æœŸå¾…åŠ¹æœ:

æ ç•ªã¨ã®ç›¸æ€§ï¼ˆå†…æ  Ã— é€ƒã’é¦¬ï¼‰
ãƒšãƒ¼ã‚¹é©æ€§ã®æ¨å®š
ææ¡ˆ B-3: Embedding ã®æ´»ç”¨ â­ï¸â­ï¸
å®Ÿè£…æ¦‚è¦:

import torch
import torch.nn as nn

class HorseEmbedding(nn.Module):
def **init**(self, num_horses, embedding_dim=16):
super().**init**()
self.embedding = nn.Embedding(num_horses, embedding_dim)
self.fc = nn.Linear(embedding_dim, 1)

    def forward(self, horse_ids):
        embedded = self.embedding(horse_ids)
        output = self.fc(embedded)
        return output, embedded

# å­¦ç¿’å¾Œã€embedded ã‚’ç‰¹å¾´é‡ã¨ã—ã¦ä½¿ç”¨

å®Ÿè£…å„ªå…ˆåº¦: ä¸­ï¼ˆåŠ¹æœã¯é«˜ã„ãŒå®Ÿè£…ã‚³ã‚¹ãƒˆå¤§ï¼‰

5.3 ãƒ¢ãƒ‡ãƒ«å­¦ç¿’ãƒ—ãƒ­ã‚»ã‚¹ã®æ”¹å–„
ææ¡ˆ C-1: ãƒã‚¤ãƒ‘ãƒ¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æœ€é©åŒ–ã®è‡ªå‹•åŒ– â­ï¸â­ï¸â­ï¸
å®Ÿè£…: Optuna ã®å°å…¥

import optuna

def objective(trial):
params = {
'num_leaves': trial.suggest_int('num_leaves', 20, 100),
'learning_rate': trial.suggest_float('learning_rate', 0.001, 0.1),
'n_estimators': trial.suggest_int('n_estimators', 500, 3000),
'min_child_samples': trial.suggest_int('min_child_samples', 5, 100),
}

    model = lgb.LGBMRegressor(**params)
    model.fit(X_train, y_train)

    y_pred = model.predict(X_valid)
    score = mean_squared_error(y_valid, y_pred)

    return score

study = optuna.create_study(direction='minimize')
study.optimize(objective, n_trials=100)
æœŸå¾…åŠ¹æœ:

æ‰‹å‹•èª¿æ•´ã§ã¯è¦‹ã¤ã‹ã‚‰ãªã„æœ€é©ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®ç™ºè¦‹
å®šæœŸçš„ãªå†æœ€é©åŒ–ã«ã‚ˆã‚‹æ€§èƒ½ç¶­æŒ
å®Ÿè£…å„ªå…ˆåº¦: æœ€é«˜

ææ¡ˆ C-2: ã‚«ã‚¹ã‚¿ãƒ æå¤±é–¢æ•°ã®å°å…¥ â­ï¸â­ï¸
Focal Loss ã®å®Ÿè£…:

def focal_loss_lgb(y_true, y_pred):
"""é›£ã—ã„ã‚µãƒ³ãƒ—ãƒ«ã«é‡ç‚¹ã‚’ç½®ãæå¤±é–¢æ•°"""
alpha = 0.25
gamma = 2.0

    p = 1 / (1 + np.exp(-y_pred))
    loss = -alpha * (1 - p) ** gamma * y_true * np.log(p) - \
           (1 - alpha) * p ** gamma * (1 - y_true) * np.log(1 - p)

    grad = ...  # å‹¾é…è¨ˆç®—
    hess = ...  # ãƒ˜ãƒƒã‚»è¡Œåˆ—è¨ˆç®—

    return grad, hess

model = lgb.LGBMClassifier(objective=focal_loss_lgb)
æœŸå¾…åŠ¹æœ:

å¤§ç©´é¦¬åˆ¸ã®äºˆæ¸¬ç²¾åº¦å‘ä¸Š
ä¸å‡è¡¡ãƒ‡ãƒ¼ã‚¿ã¸ã®å¯¾å¿œ
5.4 å®Ÿé¨“ç®¡ç†åŸºç›¤ã®æ§‹ç¯‰
ææ¡ˆ D-1: MLflow ã®å°å…¥ â­ï¸â­ï¸
å®Ÿè£…:

import mlflow

# å­¦ç¿’ã‚¹ã‚¯ãƒªãƒ—ãƒˆã«è¿½åŠ 

with mlflow.start_run(): # ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿è¨˜éŒ²
mlflow.log_params(model_params)

    # å­¦ç¿’
    model.fit(X_train, y_train)

    # ãƒ¡ãƒˆãƒªã‚¯ã‚¹è¨˜éŒ²
    mlflow.log_metric("brier_score", brier_score)
    mlflow.log_metric("ece", ece)
    mlflow.log_metric("ndcg", ndcg)

    # ãƒ¢ãƒ‡ãƒ«ä¿å­˜
    mlflow.sklearn.log_model(model, "mu_model")

åˆ©ç‚¹:

Web UI ã§å®Ÿé¨“å±¥æ­´ã‚’å¯è¦–åŒ–
ãƒ¢ãƒ‡ãƒ«ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†
å†ç¾æ€§ã®ç¢ºä¿ 6. å„ªå…ˆé †ä½ä»˜ããƒ­ãƒ¼ãƒ‰ãƒãƒƒãƒ—
ãƒ•ã‚§ãƒ¼ã‚º 1ï¼ˆçŸ­æœŸ: 1-2 ãƒ¶æœˆï¼‰ - å³åŠ¹æ€§ã®é«˜ã„æ”¹å–„
| ææ¡ˆ | å®Ÿè£…é›£æ˜“åº¦ | æœŸå¾…åŠ¹æœ | å„ªå…ˆåº¦ | |------|-----------|----------|--------| | C-1: Optuna ã§ãƒã‚¤ãƒ‘ãƒ¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æœ€é©åŒ– | ä¸­ | é«˜ | â­ï¸â­ï¸â­ï¸ | | A-1: é¦¬éå»æˆç¸¾ãƒ†ãƒ¼ãƒ–ãƒ«ã®ä¿å­˜ | ä¸­ | é«˜ | â­ï¸â­ï¸â­ï¸ | | B-1: äº¤äº’ä½œç”¨ç‰¹å¾´é‡ã®å°å…¥ | ä¸­ | é«˜ | â­ï¸â­ï¸â­ï¸ | | D-1: MLflow ã®å°å…¥ | ä½ | ä¸­ | â­ï¸â­ï¸ |

å®Ÿè£…é †åº:

MLflow ã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ï¼ˆå®Ÿé¨“è¨˜éŒ²ã®åŸºç›¤ï¼‰
Optuna ã§ Î¼ ãƒ¢ãƒ‡ãƒ«ã®ãƒã‚¤ãƒ‘ãƒ¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æœ€é©åŒ–
é¦¬éå»æˆç¸¾ãƒ‡ãƒ¼ã‚¿ã®ä¿å­˜å‡¦ç†è¿½åŠ 
äº¤äº’ä½œç”¨ç‰¹å¾´é‡ã®å®Ÿè£…ã¨ãƒ†ã‚¹ãƒˆ
æœŸå¾…ã•ã‚Œã‚‹æ”¹å–„å¹…: Brier Score 5-10%æ”¹å–„

ãƒ•ã‚§ãƒ¼ã‚º 2ï¼ˆä¸­æœŸ: 3-6 ãƒ¶æœˆï¼‰ - ç‰¹å¾´é‡ã®æ‹¡å……
| ææ¡ˆ | å®Ÿè£…é›£æ˜“åº¦ | æœŸå¾…åŠ¹æœ | å„ªå…ˆåº¦ | |------|-----------|----------|--------| | B-2: è„šè³ªã®å®šç¾©ã¨ç‰¹å¾´é‡åŒ– | ä¸­ | ä¸­ | â­ï¸â­ï¸ | | A-2: è¡€çµ±è©³ç´°æƒ…å ±ã®è¿½åŠ  | ä½ | ä¸­ | â­ï¸â­ï¸ | | A-3: å‡ºé¦¬è¡¨è¿½åŠ æƒ…å ±ï¼ˆãƒ–ãƒªãƒ³ã‚«ãƒ¼ç­‰ï¼‰ | ä½ | ä½ | â­ï¸ |

ãƒ•ã‚§ãƒ¼ã‚º 3ï¼ˆé•·æœŸ: 6 ãƒ¶æœˆã€œï¼‰ - é«˜åº¦ãªæ‰‹æ³•ã®å°å…¥
| ææ¡ˆ | å®Ÿè£…é›£æ˜“åº¦ | æœŸå¾…åŠ¹æœ | å„ªå…ˆåº¦ | |------|-----------|----------|--------| | B-3: Embedding ã®æ´»ç”¨ | é«˜ | é«˜ | â­ï¸â­ï¸ | | C-2: Focal Loss ã®å®Ÿè£… | é«˜ | ä¸­ | â­ï¸â­ï¸ |

7. çµè«–
   7.1 ã‚·ã‚¹ãƒ†ãƒ ã®æˆç†Ÿåº¦è©•ä¾¡
   KeibaAI_v2 ã¯ã€å€‹äººç ”ç©¶ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¨ã—ã¦ã¯éå¸¸ã«é«˜åº¦ãªè¨­è¨ˆã‚’æŒã¤ã‚·ã‚¹ãƒ†ãƒ ã§ã™ã€‚ç‰¹ã«ä»¥ä¸‹ã®ç‚¹ãŒå„ªã‚Œã¦ã„ã¾ã™ï¼š

âœ… å …ç‰¢ãªã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£: Î¼, Ïƒ, Î½ ã® 3 ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«åŒ– âœ… æ™‚ç³»åˆ—ãƒªãƒ¼ã‚¯å¯¾ç­–: shift()ã«ã‚ˆã‚‹å³å¯†ãªéå»ãƒ‡ãƒ¼ã‚¿ä½¿ç”¨ âœ… æŸ”è»Ÿãªç‰¹å¾´é‡ç”Ÿæˆ: YAML ãƒ¬ã‚·ãƒ”ãƒ™ãƒ¼ã‚¹ã‚·ã‚¹ãƒ†ãƒ  âœ… ãƒ‡ãƒ¼ã‚¿å“è³ªæ”¹å–„: HTML ãƒ‘ãƒ¼ã‚µãƒ¼ä¿®æ­£ã«ã‚ˆã‚Šæ¬ æç‡ã»ã¼ 0%é”æˆ

7.2 æœ€å„ªå…ˆã§å–ã‚Šçµ„ã‚€ã¹ãæ”¹å–„
ãƒã‚¤ãƒ‘ãƒ¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æœ€é©åŒ–ã®è‡ªå‹•åŒ– (Optuna)

åŠ´åŠ›å¯¾åŠ¹æœãŒæœ€å¤§
å³åº§ã«ãƒ¢ãƒ‡ãƒ«æ€§èƒ½å‘ä¸ŠãŒæœŸå¾…ã§ãã‚‹
é¦¬éå»æˆç¸¾ãƒ‡ãƒ¼ã‚¿ã®ä¿å­˜

æ—¢å­˜ã®ãƒ‘ãƒ¼ã‚µãƒ¼ã‚³ãƒ¼ãƒ‰ãŒåˆ©ç”¨å¯èƒ½
ç‰¹å¾´é‡ã®è³ªã‚’å¤§å¹…ã«å‘ä¸Š
äº¤äº’ä½œç”¨ç‰¹å¾´é‡ã®ä½“ç³»çš„å°å…¥

YAML ãƒ¬ã‚·ãƒ”ã®æ‹¡å¼µã§å®Ÿè£…å¯èƒ½
ãƒ‰ãƒ¡ã‚¤ãƒ³çŸ¥è­˜ã‚’åŠ¹æœçš„ã«æ³¨å…¥
7.3 æœŸå¾…ã•ã‚Œã‚‹æˆæœ
ä¸Šè¨˜ã®æ”¹å–„ã‚’æ®µéšçš„ã«å®Ÿæ–½ã™ã‚‹ã“ã¨ã§ã€ä»¥ä¸‹ã®æˆæœãŒæœŸå¾…ã•ã‚Œã¾ã™ï¼š

Brier Score: 5-10%ã®æ”¹å–„
ECEï¼ˆExpected Calibration Errorï¼‰: < 0.05 ã®é”æˆ
NDCG: é †ä½äºˆæ¸¬ç²¾åº¦ã®å‘ä¸Š
ROI: æœŸå¾…å€¤ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ç²¾åº¦ã®å‘ä¸Š
---

## ğŸ“‹ å®Ÿè£…é€²æ—è¨˜éŒ²

### å®Ÿè£…ã‚»ãƒƒã‚·ãƒ§ãƒ³: 2025-11-16

#### âœ… å®Œäº†ã—ãŸæ”¹å–„é …ç›®

##### 1. é¦¬éå»æˆç¸¾ãƒ†ãƒ¼ãƒ–ãƒ«ã®ä¿å­˜å‡¦ç†ä¿®æ­£ â­ï¸â­ï¸â­ï¸
**å®Ÿè£…æ—¥**: 2025-11-16
**å®Ÿè£…ãƒ•ã‚¡ã‚¤ãƒ«**: `keibaai/src/run_parsing_pipeline_local.py`

**å®Ÿè£…å†…å®¹**:
- `parse_horse_performance()` ã‚’æ­£ã—ãå‘¼ã³å‡ºã™ã‚ˆã†ã«ä¿®æ­£ï¼ˆ205-229è¡Œç›®ï¼‰
- lambdaé–¢æ•°ã®ãƒã‚°ã‚’ä¿®æ­£ï¼ˆãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹ã‚’ç›´æ¥æ¸¡ã™æ–¹å¼ã«å¤‰æ›´ï¼‰
- ãƒ‡ãƒ¼ã‚¿å‹ã®æœ€é©åŒ–ï¼ˆInt64å‹ï¼‰ã‚’è¿½åŠ 
- æˆç¸¾ãƒ‡ãƒ¼ã‚¿ã‚’ `horses_performance.parquet` ã¨ã—ã¦ä¿å­˜å¯èƒ½ã«

**æœŸå¾…ã•ã‚Œã‚‹åŠ¹æœ**:
- é¦¬ã®è©³ç´°ãªéå»æˆç¸¾ãƒ‡ãƒ¼ã‚¿ï¼ˆè·é›¢åˆ¥ãƒ»é¦¬å ´åˆ¥ï¼‰ãŒæ´»ç”¨å¯èƒ½
- ã‚ˆã‚Šç²¾ç·»ãªéå»èµ°ãƒ‡ãƒ¼ã‚¿ã«ã‚ˆã‚‹ç‰¹å¾´é‡ã®è³ªå‘ä¸Š
- Brier Score 3-5%ã®æ”¹å–„è¦‹è¾¼ã¿

**æŠ½å‡ºã•ã‚Œã‚‹ã‚«ãƒ©ãƒ **:
```
horse_id, race_date, venue, weather, race_number, race_name, race_grade,
head_count, bracket_number, horse_number, finish_position, jockey_name,
basis_weight, distance_m, track_surface, track_condition, finish_time_seconds,
margin_seconds, passing_order, last_3f_time, win_odds, popularity,
horse_weight, horse_weight_change, race_id
```

**æ¬¡å›å®Ÿè¡Œæ™‚ã®å‹•ä½œ**: ãƒ‘ãƒ¼ã‚¹ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³å®Ÿè¡Œæ™‚ã«è‡ªå‹•çš„ã«éå»æˆç¸¾ã‚’ä¿å­˜

---

##### 2. äº¤äº’ä½œç”¨ç‰¹å¾´é‡ã®ä½“ç³»çš„å°å…¥ â­ï¸â­ï¸â­ï¸
**å®Ÿè£…æ—¥**: 2025-11-16
**å®Ÿè£…ãƒ•ã‚¡ã‚¤ãƒ«**:
- `keibaai/configs/features.yaml`
- `keibaai/src/features/feature_engine.py`

**å®Ÿè£…å†…å®¹**:

1. **features.yaml ã¸ã®è¨­å®šè¿½åŠ ** (68-83è¡Œç›®):
```yaml
interaction_features:
  enabled: true
  interactions:
    # é¨æ‰‹ Ã— ç«¶é¦¬å ´
    - { name: jockey_venue, id_column: jockey_id, context_column: venue, ... }
    # é¨æ‰‹ Ã— è·é›¢ã‚«ãƒ†ã‚´ãƒª
    - { name: jockey_distance, id_column: jockey_id, context_column: distance_category, ... }
    # é¨æ‰‹ Ã— é¦¬å ´ç¨®åˆ¥
    - { name: jockey_surface, id_column: jockey_id, context_column: track_surface, ... }
    # ç¨®ç‰¡é¦¬ Ã— é¦¬å ´ç¨®åˆ¥
    - { name: sire_surface, id_column: sire_id, context_column: track_surface, ... }
    # ç¨®ç‰¡é¦¬ Ã— è·é›¢ã‚«ãƒ†ã‚´ãƒª
    - { name: sire_distance, id_column: sire_id, context_column: distance_category, ... }
    # èª¿æ•™å¸« Ã— ç«¶é¦¬å ´
    - { name: trainer_venue, id_column: trainer_id, context_column: venue, ... }
```

2. **feature_engine.py ã¸ã®å®Ÿè£…** (239-343è¡Œç›®):
- `_add_interaction_features()` ãƒ¡ã‚½ãƒƒãƒ‰è¿½åŠ 
- äº¤äº’ä½œç”¨ã®è‡ªå‹•ç”Ÿæˆãƒ­ã‚¸ãƒƒã‚¯ï¼ˆgroupby + pivotï¼‰
- `_add_distance_category()` ãƒ¡ã‚½ãƒƒãƒ‰è¿½åŠ ï¼ˆè·é›¢ã®ã‚«ãƒ†ã‚´ãƒªåŒ–ï¼‰

3. **è·é›¢ã‚«ãƒ†ã‚´ãƒªã®å®šç¾©**:
```python
sprint:        < 1400m    # ã‚¹ãƒ—ãƒªãƒ³ãƒˆ
mile:          1400-1799m # ãƒã‚¤ãƒ«
intermediate:  1800-2199m # ä¸­è·é›¢
long:          2200-2799m # é•·è·é›¢
marathon:      >= 2800m   # è¶…é•·è·é›¢
```

**ç”Ÿæˆã•ã‚Œã‚‹ç‰¹å¾´é‡ä¾‹**:
```
jockey_æ±äº¬_win_rate        # æ­¦è±Šé¨æ‰‹ã®æ±äº¬ç«¶é¦¬å ´å‹ç‡
jockey_sprint_win_rate      # æ­¦è±Šé¨æ‰‹ã®çŸ­è·é›¢å‹ç‡
jockey_èŠ_win_rate          # æ­¦è±Šé¨æ‰‹ã®èŠå‹ç‡
sire_èŠ_avg_finish          # ãƒ‡ã‚£ãƒ¼ãƒ—ã‚¤ãƒ³ãƒ‘ã‚¯ãƒˆç”£é§’ã®èŠå¹³å‡ç€é †
sire_mile_avg_finish        # ãƒ‡ã‚£ãƒ¼ãƒ—ã‚¤ãƒ³ãƒ‘ã‚¯ãƒˆç”£é§’ã®ãƒã‚¤ãƒ«å¹³å‡ç€é †
trainer_ä¸­å±±_win_rate       # è—¤æ²¢èª¿æ•™å¸«ã®ä¸­å±±ç«¶é¦¬å ´å‹ç‡
```

**æœŸå¾…ã•ã‚Œã‚‹åŠ¹æœ**:
- ç‰¹å®šæ¡ä»¶ä¸‹ã§ã®å„ªä½æ€§ã‚’æ‰ãˆã‚‹ï¼ˆé¨æ‰‹Ã—ç«¶é¦¬å ´ãªã©ï¼‰
- LightGBMã®æ±ºå®šæœ¨ãŒè¤‡é›‘ãªç›¸äº’ä½œç”¨ã‚’å­¦ç¿’ã—ã‚„ã™ããªã‚‹
- Brier Score 3-7%ã®æ”¹å–„è¦‹è¾¼ã¿

**æ¬¡å›ç‰¹å¾´é‡ç”Ÿæˆæ™‚ã®å‹•ä½œ**: `features.yaml` ã®è¨­å®šã«åŸºã¥ãè‡ªå‹•çš„ã«ç”Ÿæˆ

---

#### â³ æœªå®Ÿè£…ï¼ˆæ¬¡å›å„ªå…ˆï¼‰

##### 3. Optunaã«ã‚ˆã‚‹ãƒã‚¤ãƒ‘ãƒ¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æœ€é©åŒ– â­ï¸â­ï¸â­ï¸
**å„ªå…ˆåº¦**: æœ€é«˜
**å®Ÿè£…é›£æ˜“åº¦**: ä¸­
**æœŸå¾…åŠ¹æœ**: é«˜ï¼ˆBrier Score 3-5%æ”¹å–„è¦‹è¾¼ã¿ï¼‰

**å®Ÿè£…äºˆå®šå†…å®¹**:
1. Optunaãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®å°å…¥
2. æœ€é©åŒ–ã‚¹ã‚¯ãƒªãƒ—ãƒˆ `optimize_hyperparameters.py` ã®ä½œæˆ
3. LightGBMã®æ¢ç´¢ç©ºé–“å®šç¾©:
   - `num_leaves`: 20-100
   - `learning_rate`: 0.001-0.1
   - `n_estimators`: 500-3000
   - `min_child_samples`: 5-100
   - `max_depth`: 3-12
4. ãƒ™ã‚¤ã‚ºæœ€é©åŒ–ã®å®Ÿè¡Œï¼ˆ100 trialsæ¨å¥¨ï¼‰
5. æœ€é©ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®ä¿å­˜ï¼ˆmodels.yamlï¼‰

**å®Ÿè£…ã‚¿ã‚¤ãƒŸãƒ³ã‚°**: æ¬¡å›ã‚»ãƒƒã‚·ãƒ§ãƒ³

---

### ğŸ“Š å…¨ä½“é€²æ—ã‚µãƒãƒªãƒ¼

| ãƒ•ã‚§ãƒ¼ã‚º | æ”¹å–„é …ç›® | ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ | æœŸå¾…åŠ¹æœ |
|---------|---------|----------|---------|
| ãƒ•ã‚§ãƒ¼ã‚º1 | é¦¬éå»æˆç¸¾ä¿å­˜ | âœ… å®Œäº† | Brier Score 3-5%æ”¹å–„ |
| ãƒ•ã‚§ãƒ¼ã‚º1 | äº¤äº’ä½œç”¨ç‰¹å¾´é‡ | âœ… å®Œäº† | Brier Score 3-7%æ”¹å–„ |
| ãƒ•ã‚§ãƒ¼ã‚º1 | Optunaæœ€é©åŒ– | â³ æœªå®Ÿè£… | Brier Score 3-5%æ”¹å–„ |
| ãƒ•ã‚§ãƒ¼ã‚º1 | MLflowå°å…¥ | â³ æœªå®Ÿè£… | å®Ÿé¨“ç®¡ç†ã®åŠ¹ç‡åŒ– |
| ãƒ•ã‚§ãƒ¼ã‚º2 | è„šè³ªç‰¹å¾´é‡ | â³ æœªå®Ÿè£… | Brier Score 2-4%æ”¹å–„ |
| ãƒ•ã‚§ãƒ¼ã‚º2 | è¡€çµ±è©³ç´°æƒ…å ± | â³ æœªå®Ÿè£… | Brier Score 1-2%æ”¹å–„ |
| ãƒ•ã‚§ãƒ¼ã‚º3 | Embeddingæ´»ç”¨ | â³ æœªå®Ÿè£… | Brier Score 3-5%æ”¹å–„ |
| ãƒ•ã‚§ãƒ¼ã‚º3 | Focal Loss | â³ æœªå®Ÿè£… | å¤§ç©´äºˆæ¸¬ç²¾åº¦å‘ä¸Š |

**ç´¯è¨ˆæœŸå¾…æ”¹å–„**: Brier Score 6-12%æ”¹å–„ï¼ˆãƒ•ã‚§ãƒ¼ã‚º1å®Œäº†åˆ†ï¼‰

---

### ğŸ”— é–¢é€£ã‚³ãƒŸãƒƒãƒˆ

- **ã‚³ãƒŸãƒƒãƒˆãƒãƒƒã‚·ãƒ¥**: `9abf04c`
- **ãƒ–ãƒ©ãƒ³ãƒ**: `claude/improve-data-pipeline-014oreGm5qa6p4ABU8J8yK4h`
- **ã‚³ãƒŸãƒƒãƒˆæ—¥æ™‚**: 2025-11-16
- **å¤‰æ›´ãƒ•ã‚¡ã‚¤ãƒ«**:
  - `keibaai/src/run_parsing_pipeline_local.py`
  - `keibaai/configs/features.yaml`
  - `keibaai/src/features/feature_engine.py`

---

Update Todos
Read complete system specification document (å®Œå…¨ä»•æ§˜æ›¸)
Read review_report.md for existing analysis
Examine HTML data structure and parsing pipeline
Analyze parsed data schemas and columns in detail
Review feature engineering implementation
Review model implementation and training code
Analyze data quality and completeness
Generate comprehensive improvement recommendations
è£œè¶³: æ¬¡ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚¹ãƒ†ãƒƒãƒ—
ä»¥ä¸Šã®è©³ç´°åˆ†æã‚’å®Œäº†ã—ã¾ã—ãŸã€‚ä¸»è¦ãªç™ºè¦‹ã¨æ¨å¥¨äº‹é …ã‚’ã¾ã¨ã‚ã¾ã™ï¼š

ğŸ“Š ã‚·ã‚¹ãƒ†ãƒ ã®ç¾çŠ¶è©•ä¾¡
ãƒ‡ãƒ¼ã‚¿ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³:

âœ… 278,098 ãƒ¬ãƒ¼ã‚¹ã€1,377,361 è¡€çµ±ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’å‡¦ç†
âœ… HTML ãƒ‘ãƒ¼ã‚µãƒ¼æ”¹å–„ã«ã‚ˆã‚Šæ¬ æç‡ 0.8%â†’ ã»ã¼ 0%é”æˆ
âœ… 27+ã‚«ãƒ©ãƒ ã®è©³ç´°ãªãƒ¬ãƒ¼ã‚¹æƒ…å ±æŠ½å‡º
âœ… é¦¬éå»æˆç¸¾ãƒ‡ãƒ¼ã‚¿ã®ä¿å­˜å‡¦ç†ã‚’ä¿®æ­£ï¼ˆ2025-11-16å®Ÿè£…å®Œäº†ï¼‰
ç‰¹å¾´é‡ç”Ÿæˆ:

âœ… ãƒ¬ã‚·ãƒ”ãƒ™ãƒ¼ã‚¹ã®æŸ”è»Ÿãªã‚·ã‚¹ãƒ†ãƒ å®Ÿè£…æ¸ˆã¿
âœ… æ™‚ç³»åˆ—ãƒªãƒ¼ã‚¯å¯¾ç­–ï¼ˆshift()ä½¿ç”¨ï¼‰ãŒå®Œç’§
âœ… äº¤äº’ä½œç”¨ç‰¹å¾´é‡ã‚’ä½“ç³»çš„ã«å°å…¥ï¼ˆ2025-11-16å®Ÿè£…å®Œäº†ï¼‰
âš ï¸ è„šè³ªã€Embedding ãŒæœªå®Ÿè£…
ãƒ¢ãƒ‡ãƒ«:

âœ… Î¼ï¼ˆRegressor+Rankerï¼‰ã®æ´—ç·´ã•ã‚ŒãŸè¨­è¨ˆ
âš ï¸ ãƒã‚¤ãƒ‘ãƒ¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãŒå›ºå®šå€¤ï¼ˆæœ€é©åŒ–æœªå®Ÿæ–½ï¼‰â† æ¬¡å›å„ªå…ˆ
âš ï¸ ã‚«ã‚¹ã‚¿ãƒ æå¤±é–¢æ•°æœªå°å…¥
ğŸ¯ æ¬¡å›å„ªå…ˆã§å–ã‚Šçµ„ã‚€ã¹ãæ”¹å–„
Optuna ã«ã‚ˆã‚‹ãƒã‚¤ãƒ‘ãƒ¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æœ€é©åŒ–

å®Ÿè£…é›£æ˜“åº¦: ä¸­ / æœŸå¾…åŠ¹æœ: é«˜
å³åº§ã«ãƒ¢ãƒ‡ãƒ«æ€§èƒ½å‘ä¸ŠãŒè¦‹è¾¼ã‚ã‚‹
ãƒ•ã‚§ãƒ¼ã‚º1ã®æœ€å¾Œã®é‡è¦æ”¹å–„
MLflow ã®å°å…¥

å®Ÿè£…é›£æ˜“åº¦: ä½ / æœŸå¾…åŠ¹æœ: ä¸­
å®Ÿé¨“ç®¡ç†ã®åŠ¹ç‡åŒ–
ãƒ¢ãƒ‡ãƒ«ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†ã®è‡ªå‹•åŒ–
è„šè³ªç‰¹å¾´é‡ã®å®šç¾©ã¨å®Ÿè£…

å®Ÿè£…é›£æ˜“åº¦: ä¸­ / æœŸå¾…åŠ¹æœ: ä¸­
éå»ã®é€šéé †ä½ã‹ã‚‰è„šè³ªã‚’åˆ†é¡
æ ç•ªã¨ã®ç›¸æ€§ã‚’æ‰ãˆã‚‹
ğŸ“ æä¾›ã—ãŸåˆ†æå†…å®¹
âœ… ãƒ‡ãƒ¼ã‚¿ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³å…¨ä½“ã®è©³ç´°ãƒ•ãƒ­ãƒ¼
âœ… å„ãƒ‘ãƒ¼ã‚µãƒ¼ã§æŠ½å‡ºã•ã‚Œã‚‹å…¨ã‚«ãƒ©ãƒ ã®ãƒªã‚¹ãƒˆ
âœ… ç‰¹å¾´é‡ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ãƒªãƒ³ã‚°ã®ç¾çŠ¶ã¨æœªå®Ÿè£…æ©Ÿèƒ½
âœ… ãƒ¢ãƒ‡ãƒ«ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã®è©³ç´°åˆ†æ
âœ… å„ªå…ˆåº¦ä»˜ãæ”¹å–„ãƒ­ãƒ¼ãƒ‰ãƒãƒƒãƒ—ï¼ˆãƒ•ã‚§ãƒ¼ã‚º 1-3ï¼‰
âœ… å…·ä½“çš„ãªå®Ÿè£…ä¾‹ã¨ã‚³ãƒ¼ãƒ‰ã‚¹ãƒ‹ãƒšãƒƒãƒˆ
âœ… ãƒ•ã‚§ãƒ¼ã‚º1ã®2ã¤ã®æ”¹å–„ã‚’å®Ÿè£…å®Œäº†ï¼ˆ2025-11-16ï¼‰
ã“ã®åˆ†æãƒ¬ãƒãƒ¼ãƒˆã‚’åŸºã«ã€ãƒ¢ãƒ‡ãƒ«ç²¾åº¦å‘ä¸Šã«å‘ã‘ãŸæ®µéšçš„ãªæ”¹å–„ã‚’é€²ã‚ã¦ã„ã¾ã™ã€‚ãƒ•ã‚§ãƒ¼ã‚º 1 ã®å®Ÿè£…ã«ã‚ˆã‚Šã€Brier Score ã§ 6-12%ã®æ”¹å–„ãŒæœŸå¾…ã§ãã¾ã™ã€‚
